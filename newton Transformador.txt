clear

basemva=100;

%Acelerar
accel=1;

%Exactitud
accuracy=0.0001;

maxiter=80;

% 1--slack
% 0--load
% 2--generation

%	bus	bus	voltage	angle	----Load----	-----Generator-----Injected
%	No	code	mag	degree	MW	Mvar	MW	Mvar	Qmin	Qmax	Mvar	
busdata=[1	1 	1.01	0	0	0	0	0	0	0	0
	2	0	1	0	60	35	0	0	0	0	0
	3	0	1	0	70	42	0	0	0	0	18
	4	0	1	0	80	50	0	0	0	0	15
	5	2	1	0	65	36	190	0	0	0	0
];

%	Bus	bus	R	X	1/2 B	TAP
%	NL	NR	pu	pu	pu
linedata=[1	2	0.0108	0.0649	0	1
	1	4	0.0235	0.0941	0	1
	2	3	0	0.04	0	1/0.975
	2	5	0.0118	0.0471	0	1
	3	5	0.0147	0.0588	0	1
	4	5	0.0118	0.0529	0	1];

%lfybus
%Ybus
%lfnewton
%busout
%lineflow



y =

   4.9931 -24.9963i  -2.4950 +14.9931i   0.0000 + 0.0000i  -2.4981 +10.0031i   0.0000 + 0.0000i
  -2.4950 +14.9931i   7.5000 -58.7363i   0.0000 +24.3750i   0.0000 + 0.0000i  -5.0050 +19.9775i
   0.0000 + 0.0000i   0.0000 +24.3750i   4.0016 -41.0064i   0.0000 + 0.0000i  -4.0016 +16.0064i
  -2.4981 +10.0031i   0.0000 + 0.0000i   0.0000 + 0.0000i   6.5149 -28.0107i  -4.0168 +18.0076i
   0.0000 + 0.0000i  -5.0050 +19.9775i  -4.0016 +16.0064i  -4.0168 +18.0076i  13.0234 -53.9915i

angulo =

         0   -1.6334   -2.1502   -1.8892   -0.7528


v =

    1.0100    0.9925    0.9718    0.9847    1.0000


vol =

   1.0100 + 0.0000i   0.9921 - 0.0283i   0.9711 - 0.0365i   0.9842 - 0.0325i   0.9999 - 0.0131i


cor =

   0.0000 + 0.0000i   0.4688 - 0.1977i   0.0000 + 0.0000i   0.3892 - 0.1769i   0.0000 + 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.2163 + 0.0920i   0.0000 + 0.0000i  -0.3418 + 0.0801i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.4887 + 0.3682i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.4111 + 0.2051i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i


cor =

   0.0000 + 0.0000i   0.4688 - 0.1977i   0.0000 + 0.0000i   0.3892 - 0.1769i   0.0000 + 0.0000i
  -0.4688 + 0.1977i   0.0000 + 0.0000i   0.2163 + 0.0920i   0.0000 + 0.0000i  -0.3418 + 0.0801i
   0.0000 + 0.0000i  -0.2219 - 0.0944i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.4887 + 0.3682i
  -0.3892 + 0.1769i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.4111 + 0.2051i
   0.0000 + 0.0000i   0.3418 - 0.0801i   0.4887 - 0.3682i   0.4111 - 0.2051i   0.0000 + 0.0000i


scomlinea =

   0.0000 + 0.0000i   0.4735 + 0.1996i   0.0000 + 0.0000i   0.3930 + 0.1786i   0.0000 + 0.0000i
  -0.4707 - 0.1828i   0.0000 + 0.0000i   0.2120 - 0.0974i   0.0000 + 0.0000i  -0.3413 - 0.0698i
   0.0000 + 0.0000i  -0.2120 + 0.0997i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.4880 - 0.3397i
  -0.3888 - 0.1614i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.4112 - 0.1886i
   0.0000 + 0.0000i   0.3428 + 0.0756i   0.4935 + 0.3617i   0.4137 + 0.1997i   0.0000 + 0.0000i


scomperdidas =

   0.0000 + 0.0000i   0.0028 + 0.0168i   0.0000 + 0.0000i   0.0043 + 0.0172i   0.0000 + 0.0000i
   0.0028 + 0.0168i   0.0000 + 0.0000i  -0.0000 + 0.0023i   0.0000 + 0.0000i   0.0015 + 0.0058i
   0.0000 + 0.0000i  -0.0000 + 0.0023i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0055 + 0.0220i
   0.0043 + 0.0172i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0025 + 0.0112i
   0.0000 + 0.0000i   0.0015 + 0.0058i   0.0055 + 0.0220i   0.0025 + 0.0112i   0.0000 + 0.0000i


scomnodos =

   0.8665 + 0.3783i  -0.6000 - 0.3500i  -0.7000 - 0.2400i  -0.8000 - 0.3500i   1.2500 + 0.6370i



                           Line Flow and Losses 

     --Line--  Power at bus & line flow    --Line loss--  Transformer
     from  to    MW      Mvar     MVA       MW      Mvar      tap
   
     1         86.651   37.826   94.548
           2   47.349   19.963   51.385    0.280    1.680
           4   39.305   17.864   43.174    0.429    1.719
   
     2        -60.000  -35.000   69.462
           1  -47.069  -18.283   50.496    0.280    1.680
           3   21.204   -9.740   23.334   -0.000    0.233    1.026
           5  -34.135   -6.977   34.840    0.145    0.580
   
     3        -70.000  -24.000   74.000
           2  -21.204    9.972   23.432   -0.000    0.233
           5  -48.796  -33.972   59.457    0.550    2.201
   
     4        -80.000  -35.000   87.321
           1  -38.875  -16.145   42.094    0.429    1.719
           5  -41.125  -18.855   45.241    0.249    1.117
   
     5        125.000   63.698  140.294
           2   34.280    7.558   35.103    0.145    0.580
           3   49.346   36.173   61.185    0.550    2.201
           4   41.374   19.972   45.942    0.249    1.117
   
    Total loss                             1.654    7.530


%lineflow
                   Power Flow Solution by Newton-Raphson Method
                      Maximum Power Mismatch = 3.69883e-05 
                             No. of Iterations = 3 

    Bus  Voltage  Angle    ------Load------    ---Generation---   Injected
    No.  Mag.     Degree     MW       Mvar       MW       Mvar       Mvar 
                                                                          
     1   1.010    0.000     0.000     0.000    86.651    37.826     0.000
     2   0.993   -1.633    60.000    35.000     0.000     0.000     0.000
     3   0.972   -2.150    70.000    42.000     0.000     0.000    18.000
     4   0.985   -1.889    80.000    50.000     0.000     0.000    15.000
     5   1.000   -0.753    65.000    36.000   190.000    99.698     0.000
      
    Total                 275.000   163.000   276.651   137.524    33.000

clear

basemva=100;

%Acelerar
accel=1;

%Exactitud
accuracy=0.0001;

maxiter=80;

% 1--slack
% 0--load
% 2--generation

%	bus	bus	voltage	angle	----Load----	-----Generator-----Injected
%	No	code	mag	degree	MW	Mvar	MW	Mvar	Qmin	Qmax	Mvar	
busdata=[1	0 	1	0	30	18	0	0	0	0	0
	2	0	1	0	55	13	0	0	0	0	0
	3	2	1.1	0	0	0	50	0	0	0	0
	4	1	1.05	0	0	0	0	0	0	0	0
];

%	Bus	bus	R	X	1/2 B	TAP
%	NL	NR	pu	pu	pu
linedata=[1	2	0.1	0.4	0.01528	1
	1	3	0	0.3	0	1/1.1
	1	4	0.12	0.5	0.01920	1
	2	4	0.08	0.4	0.01413	1];

lfybus
%Ybus
lfnewton
busout
lineflow

                   Power Flow Solution by Newton-Raphson Method
                      Maximum Power Mismatch = 1.10419e-07 
                             No. of Iterations = 4 

    Bus  Voltage  Angle    ------Load------    ---Generation---   Injected
    No.  Mag.     Degree     MW       Mvar       MW       Mvar       Mvar 
                                                                          
     1  0.9847  -0.5002   30.0000   18.0000    0.0000    0.0000    0.0000
     2  0.9648  -6.4503   55.0000   13.0000    0.0000    0.0000    0.0000
     3  1.1000   6.7323    0.0000    0.0000   50.0000    9.3411    0.0000
     4  1.0500   0.0000    0.0000    0.0000   36.7883   26.4698    0.0000
      
    Total                 85.0000   31.0000   86.7883   35.8109    0.0000

>> lineflow

                           Line Flow and Losses 

     --Line--  Power at bus & line flow    --Line loss--  Transformer
     from  to    MW      Mvar     MVA       MW      Mvar      tap
   
     1        -30.000  -18.000   34.986
           2   24.624   -1.465   24.668    0.625   -0.402
           3  -50.000   -2.926   50.086   -0.000    6.415    0.909
           4   -4.624  -13.609   14.373    0.197   -3.157
   
     2        -55.000  -13.000   56.515
           1  -23.999    1.063   24.023    0.625   -0.402
           4  -31.001  -14.063   34.041    0.966    1.955
   
     3         50.000    9.341   50.865
           1   50.000    9.341   50.865   -0.000    6.415
   
     4         36.788   26.470   45.321
           1    4.822   10.452   11.511    0.197   -3.157
           2   31.967   16.018   35.755    0.966    1.955
   
    Total loss                             1.788    4.811